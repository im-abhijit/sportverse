import{j as e,v as L,w as O,x as te,y as R,I as M,z,E,F as A,G as F,H as V,J as oe,K as ne,O as $,M as B,N as re,Q as X,U as H,W as le,X as ie}from"./ui-B75sWwG2.js";import{r as n,u as G,L as P}from"./vendor-CNUPXUkP.js";import{c as u,B as h,u as p}from"./index-B1V6OKtR.js";import{o as de,p as ce,q as me,X as ue,R as pe,A as fe,r as xe}from"./utils-E33ow1TR.js";import{I as K,L as he}from"./label-B0yGnVM1.js";import{S as ge,a as Ne,b as ye,c as be,d as T}from"./select-C-Bdqa44.js";import{g as D,v as je}from"./authApi-CqZS-amf.js";const ve=oe,we=ne,Se=n.forwardRef(({className:a,inset:t,children:s,...l},d)=>e.jsxs(L,{ref:d,className:u("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",a),...l,children:[s,e.jsx(de,{className:"ml-auto h-4 w-4"})]}));Se.displayName=L.displayName;const Ie=n.forwardRef(({className:a,...t},s)=>e.jsx(O,{ref:s,className:u("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t}));Ie.displayName=O.displayName;const q=n.forwardRef(({className:a,sideOffset:t=4,...s},l)=>e.jsx(te,{children:e.jsx(R,{ref:l,sideOffset:t,className:u("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}));q.displayName=R.displayName;const C=n.forwardRef(({className:a,inset:t,...s},l)=>e.jsx(M,{ref:l,className:u("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",a),...s}));C.displayName=M.displayName;const Pe=n.forwardRef(({className:a,children:t,checked:s,...l},d)=>e.jsxs(z,{ref:d,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),checked:s,...l,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(E,{children:e.jsx(ce,{className:"h-4 w-4"})})}),t]}));Pe.displayName=z.displayName;const ke=n.forwardRef(({className:a,children:t,...s},l)=>e.jsxs(A,{ref:l,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(E,{children:e.jsx(me,{className:"h-2 w-2 fill-current"})})}),t]}));ke.displayName=A.displayName;const Ce=n.forwardRef(({className:a,inset:t,...s},l)=>e.jsx(F,{ref:l,className:u("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...s}));Ce.displayName=F.displayName;const Te=n.forwardRef(({className:a,...t},s)=>e.jsx(V,{ref:s,className:u("-mx-1 my-1 h-px bg-muted",a),...t}));Te.displayName=V.displayName;const De=le,Le=ie,J=n.forwardRef(({className:a,...t},s)=>e.jsx($,{ref:s,className:u("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t}));J.displayName=$.displayName;const Q=n.forwardRef(({className:a,children:t,...s},l)=>e.jsxs(Le,{children:[e.jsx(J,{}),e.jsxs(B,{ref:l,className:u("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[t,e.jsxs(re,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Q.displayName=B.displayName;const U=({className:a,...t})=>e.jsx("div",{className:u("flex flex-col space-y-1.5 text-center sm:text-left",a),...t});U.displayName="DialogHeader";const W=n.forwardRef(({className:a,...t},s)=>e.jsx(X,{ref:s,className:u("text-lg font-semibold leading-none tracking-tight",a),...t}));W.displayName=X.displayName;const Oe=n.forwardRef(({className:a,...t},s)=>e.jsx(H,{ref:s,className:u("text-sm text-muted-foreground",a),...t}));Oe.displayName=H.displayName;const Re=({value:a,onChange:t,length:s=6,disabled:l=!1})=>{const d=n.useRef([]);n.useEffect(()=>{d.current=d.current.slice(0,s)},[s]);const g=(c,r)=>{var x,k;if(r.length>1){const y=r.slice(0,s);t(y);const b=Math.min(y.length-1,s-1);(x=d.current[b])==null||x.focus();return}const o=a.split("");o[c]=r;const f=o.join("").slice(0,s);t(f),r&&c<s-1&&((k=d.current[c+1])==null||k.focus())},v=(c,r)=>{var o;r.key==="Backspace"&&!a[c]&&c>0&&((o=d.current[c-1])==null||o.focus())},N=c=>{var o;c.preventDefault();const r=c.clipboardData.getData("text").replace(/\D/g,"");if(r.length<=s){t(r);const f=Math.min(r.length-1,s-1);(o=d.current[f])==null||o.focus()}};return e.jsx("div",{className:"flex gap-2 justify-center",children:Array.from({length:s},(c,r)=>e.jsx(K,{ref:o=>d.current[r]=o,type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:a[r]||"",onChange:o=>g(r,o.target.value),onKeyDown:o=>v(r,o),onPaste:N,disabled:l,className:"w-12 h-12 text-center text-lg font-semibold border-2 focus:border-primary"},r))})},Me=({isOpen:a,onClose:t,initialMode:s="login",onLoginSuccess:l,redirectOnSuccessTo:d="/dashboard"})=>{const g=G(),[v,N]=n.useState(s),[c,r]=n.useState("phone"),[o,f]=n.useState(""),[x,k]=n.useState("+91"),[y,b]=n.useState(""),[j,w]=n.useState(!1),[S,I]=n.useState(0),[Y,_]=n.useState("");n.useEffect(()=>{a&&(r("phone"),f(""),b(""),I(0),N(s))},[a,s]),n.useEffect(()=>{if(S>0){const i=setTimeout(()=>I(S-1),1e3);return()=>clearTimeout(i)}},[S]);const Z=async()=>{if(!o||o.length<10){p.error("Please enter a valid phone number");return}w(!0);try{const i=`${x}${o}`,m=await D(i,"sms");m.success?(r("otp"),_(`${x} ${o.slice(0,3)}XXXXX${o.slice(-3)}`),I(30),p.success("OTP sent successfully!")):p.error(m.message||"Failed to send OTP")}catch(i){p.error(i instanceof Error?i.message:"Failed to send OTP. Please try again.")}finally{w(!1)}},ee=async()=>{if(y.length!==6){p.error("Please enter the complete OTP");return}w(!0);try{const i=`${x}${o}`,m=await je(i,y);m.success&&m.valid?(p.success("Login successful!"),localStorage.setItem("isLoggedIn","true"),m.userId&&localStorage.setItem("userId",m.userId),m.userName&&localStorage.setItem("userName",m.userName),localStorage.setItem("userPhoneNumber",i),l==null||l(),t(),d&&g(d)):(p.error(m.message||"Invalid OTP. Please try again."),localStorage.removeItem("userId"),localStorage.removeItem("userName"),localStorage.removeItem("userPhoneNumber"),b(""))}catch(i){p.error(i instanceof Error?i.message:"Failed to verify OTP. Please try again."),b("")}finally{w(!1)}},se=async()=>{if(!(S>0)){w(!0);try{const i=`${x}${o}`,m=await D(i,"sms");m.success?(I(30),p.success("OTP resent successfully!")):p.error(m.message||"Failed to resend OTP")}catch(i){p.error(i instanceof Error?i.message:"Failed to resend OTP. Please try again.")}finally{w(!1)}}},ae=()=>{r("phone"),b(""),I(0)};return e.jsx(De,{open:a,onOpenChange:t,children:e.jsxs(Q,{className:"sm:max-w-md",children:[e.jsxs(U,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"gradient-primary rounded-xl px-4 py-2",children:e.jsx("span",{className:"text-2xl font-bold text-primary-foreground",children:"SportVerse"})})}),e.jsx(W,{className:"text-lg text-muted-foreground",children:"Book or List Your Sports Venue Instantly ðŸâš½ðŸ¸"})]}),e.jsx("div",{className:"space-y-6",children:c==="phone"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(he,{htmlFor:"phone",className:"text-sm font-medium",children:"Enter your phone number"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(ge,{value:x,onValueChange:k,children:[e.jsx(Ne,{className:"w-24",children:e.jsx(ye,{})}),e.jsxs(be,{children:[e.jsx(T,{value:"+91",children:"+91"}),e.jsx(T,{value:"+1",children:"+1"}),e.jsx(T,{value:"+44",children:"+44"})]})]}),e.jsx(K,{id:"phone",type:"tel",placeholder:"Enter phone number",value:o,onChange:i=>f(i.target.value.replace(/\D/g,"")),className:"flex-1",maxLength:10})]})]})}),e.jsx(h,{onClick:Z,disabled:j||o.length<10,className:"w-full",size:"lg",children:j?"Sending...":"Send OTP"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Enter the 6-digit OTP sent to ",Y]}),e.jsx(Re,{value:y,onChange:b,disabled:j})]}),e.jsx("div",{className:"text-center",children:S>0?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Resend OTP in ",S,"s"]}):e.jsxs(h,{variant:"link",onClick:se,disabled:j,className:"text-sm",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"Resend OTP"]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",onClick:ae,disabled:j,className:"flex-1",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(h,{onClick:ee,disabled:j||y.length!==6,className:"flex-1",children:j?"Verifying...":"Verify OTP"})]})]})})]})})},Xe=()=>{const a=G(),[t,s]=n.useState(!1),[l,d]=n.useState("login"),[g,v]=n.useState(!1);n.useEffect(()=>{const o=()=>{const f=localStorage.getItem("isLoggedIn");v(f==="true")};return o(),window.addEventListener("storage",o),()=>{window.removeEventListener("storage",o)}},[]);const N=o=>{if(localStorage.getItem("isLoggedIn")==="true"&&o==="venue"){a("/partner/list-venue");return}d(o),s(!0)},c=()=>{v(!0)},r=()=>{localStorage.removeItem("isLoggedIn"),v(!1),window.location.href="/"};return e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsx(P,{to:"/",className:"flex items-center space-x-2","aria-label":"Sportverse Home",children:e.jsx("div",{className:"gradient-primary rounded-xl px-3 py-2",children:e.jsx("span",{className:"text-xl font-bold text-primary-foreground",children:"Sportverse"})})}),e.jsxs("nav",{className:"hidden sm:flex items-center space-x-4 md:space-x-6 lg:space-x-8","aria-label":"Main navigation",children:[e.jsx(P,{to:"/",className:"text-xs sm:text-sm font-medium transition-colors hover:text-primary","aria-label":"Go to home page",children:"Home"}),g&&e.jsx(P,{to:"/dashboard",className:"text-xs sm:text-sm font-medium transition-colors hover:text-primary","aria-label":"View my bookings",children:"My Bookings"}),e.jsx(h,{variant:"default",size:"sm",className:"text-xs sm:text-sm",onClick:()=>N("venue"),"aria-label":"List your venue",children:"List your venue"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[g?e.jsx(h,{variant:"default",size:"sm",onClick:r,"aria-label":"Logout",children:"Logout"}):e.jsx(h,{variant:"default",size:"sm",onClick:()=>N("login"),"aria-label":"Login",children:"Login"}),e.jsxs(ve,{children:[e.jsx(we,{asChild:!0,className:"sm:hidden",children:e.jsx(h,{variant:"ghost",size:"icon","aria-label":"Open navigation menu",children:e.jsx(xe,{className:"h-5 w-5"})})}),e.jsxs(q,{align:"end",className:"w-48 bg-popover","aria-label":"Navigation menu",children:[e.jsx(C,{asChild:!0,children:e.jsx(P,{to:"/",className:"cursor-pointer","aria-label":"Go to home page",children:"Home"})}),g&&e.jsx(C,{asChild:!0,children:e.jsx(P,{to:"/dashboard",className:"cursor-pointer","aria-label":"View my bookings",children:"My Bookings"})}),e.jsx(C,{className:"cursor-pointer",onClick:()=>N("venue"),"aria-label":"List your venue",children:"List your venue"})]})]})]})]})})}),e.jsx(Me,{isOpen:t,onClose:()=>s(!1),initialMode:l,onLoginSuccess:c,redirectOnSuccessTo:"/dashboard"})]})};export{Me as A,De as D,Xe as N,Q as a,U as b,W as c,Oe as d};

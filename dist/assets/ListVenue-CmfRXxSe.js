import{j as e}from"./ui-B75sWwG2.js";import{u as M,r as m}from"./vendor-CNUPXUkP.js";import{u as c,C as Z,B as h}from"./index-B1V6OKtR.js";import{L as o,I as p}from"./label-B0yGnVM1.js";import{T as H}from"./textarea-CPwiB2lw.js";import{S as J,a as K,b as X,c as Y,d as ee}from"./select-C-Bdqa44.js";import{N as se}from"./Navbar-DzlbKMxI.js";import{A as te}from"./api-BW-Pu9pH.js";import{X as f,n as F,h as D,Z as ae,e as re}from"./utils-E33ow1TR.js";import"./authApi-CqZS-amf.js";const ne=["Cricket","Badminton"],ge=()=>{const x=M();m.useEffect(()=>{const s=localStorage.getItem("partnerId"),t=localStorage.getItem("isPartnerLoggedIn");if(!s||t!=="true"){c.error("Please login to access this page"),x("/partner/login");return}},[x]);const[a,d]=m.useState({name:"",description:"",address:"",city:"",games:[""],amenities:["Flood Lights","Parking"],whatsappNumber:"",upiId:""}),[j,v]=m.useState(""),[g,y]=m.useState([]),[w,C]=m.useState([]),[I,P]=m.useState(null),[b,S]=m.useState(null),[A,k]=m.useState(!1),u=s=>{const{name:t,value:r}=s.target;d(n=>({...n,[t]:r}))},T=(s,t)=>{const r=[...a.games];r[s]=t,d(n=>({...n,games:r}))},q=()=>{d(s=>({...s,games:[...s.games,""]}))},Q=s=>{if(a.games.length>1){const t=a.games.filter((r,n)=>n!==s);d(r=>({...r,games:t}))}},L=()=>{if(j.trim()){const s=j.trim();if(a.amenities.includes(s)){c.error("This amenity already exists");return}d(t=>({...t,amenities:[...t.amenities,s]})),v("")}},V=s=>{const t=a.amenities.filter((r,n)=>n!==s);d(r=>({...r,amenities:t}))},G=s=>{if(s.target.files){const t=Array.from(s.target.files),r=[...g,...t].slice(0,3);y(r);const n=r.map(i=>URL.createObjectURL(i));C(n)}},E=s=>{const t=g.filter((n,i)=>i!==s),r=w.filter((n,i)=>i!==s);y(t),C(r)},B=s=>{if(s.target.files&&s.target.files[0]){const t=s.target.files[0];P(t);const r=URL.createObjectURL(t);S(r)}},W=()=>{P(null),b&&URL.revokeObjectURL(b),S(null)},R=s=>new Promise((t,r)=>{const n=new FileReader;n.readAsDataURL(s),n.onload=()=>t(n.result),n.onerror=i=>r(i)}),_=async s=>{if(s.preventDefault(),!a.name||!a.description||!a.address||!a.city||!a.whatsappNumber){c.error("Please fill in all required fields");return}if(a.whatsappNumber.replace(/\D/g,"").length<10){c.error("Please enter a valid WhatsApp number");return}const r=a.games.filter(n=>n.trim());if(r.length===0){c.error("Please add at least one game");return}k(!0);try{const n=await Promise.all(g.map(z=>R(z))),i=I?await R(I):null,U=localStorage.getItem("partnerId"),O=a.whatsappNumber.trim().replace(/\s+/g,""),$={name:a.name,description:a.description,games:r,amenities:a.amenities,location:`${a.address}, ${a.city}`,city:a.city,photos:n,partnerMobileNo:O,...i?{qrCodeImage:i}:{},...a.upiId?{upiId:a.upiId.trim()}:{},...U?{partnerId:U}:{}},N=await fetch(`${te}/api/venues`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!N.ok)throw new Error(`HTTP ${N.status}`);const l=await N.json();l!=null&&l.success?(c.success((l==null?void 0:l.message)||"Venue submitted successfully!"),x("/partner/dashboard")):c.error((l==null?void 0:l.message)||"Failed to submit venue")}catch{c.error("Failed to create venue. Please try again.")}finally{k(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(se,{}),e.jsx("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold mb-2",children:"List Your Venue"}),e.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Share your sports venue with the community"})]}),e.jsx(Z,{className:"p-4 md:p-6 lg:p-8",children:e.jsxs("form",{onSubmit:_,className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"name",className:"text-base font-semibold",children:"Venue Name *"}),e.jsx(p,{id:"name",name:"name",placeholder:"e.g., Elite Sports Arena",value:a.name,onChange:u,className:"mt-2",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"description",className:"text-base font-semibold",children:"Description *"}),e.jsx(H,{id:"description",name:"description",placeholder:"Describe your venue, facilities, and amenities...",value:a.description,onChange:u,className:"mt-2 min-h-[120px]",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"address",className:"text-base font-semibold",children:"Address *"}),e.jsx(p,{id:"address",name:"address",placeholder:"Street, Area, Landmark",value:a.address,onChange:u,className:"mt-2",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"city",className:"text-base font-semibold",children:"City *"}),e.jsx(p,{id:"city",name:"city",placeholder:"e.g., Mumbai",value:a.city,onChange:u,className:"mt-2",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"whatsappNumber",className:"text-base font-semibold",children:"WhatsApp Number for Booking Verification *"}),e.jsx(p,{id:"whatsappNumber",name:"whatsappNumber",type:"tel",value:a.whatsappNumber,onChange:u,className:"mt-2",required:!0}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"This number will be used for booking verification and payment screenshots"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"upiId",className:"text-base font-semibold",children:"UPI ID"}),e.jsx(p,{id:"upiId",name:"upiId",type:"text",placeholder:"e.g., yourname@paytm",value:a.upiId,onChange:u,className:"mt-2"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"UPI ID for receiving payments"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-base font-semibold",children:"QR Code Image"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-3",children:"Upload QR code for payment"}),b?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:b,alt:"QR Code",className:"w-full max-w-xs h-48 object-contain rounded-lg border"}),e.jsx("button",{type:"button",onClick:W,className:"absolute top-2 right-2 bg-destructive text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(f,{className:"h-4 w-4"})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center h-48 max-w-xs border-2 border-dashed rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx(F,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Upload QR Code"}),e.jsx("input",{type:"file",accept:"image/*",onChange:B,className:"hidden"})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-base font-semibold",children:"Sports/Games Available *"}),e.jsxs("div",{className:"mt-2 space-y-3",children:[a.games.map((s,t)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{onValueChange:r=>T(t,r),children:[e.jsx(K,{className:"w-full h-12 rounded-2xl",children:e.jsx(X,{placeholder:"Select a sport/game"})}),e.jsx(Y,{children:ne.map(r=>e.jsx(ee,{value:r,children:r},r))})]}),a.games.length>1&&e.jsx(h,{type:"button",variant:"outline",size:"icon",onClick:()=>Q(t),children:e.jsx(f,{className:"h-4 w-4"})})]},t)),e.jsxs(h,{type:"button",variant:"outline",onClick:q,disabled:a.games.length>=5,children:[e.jsx(D,{className:"h-4 w-4 mr-2"})," Add Another Game"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Add up to 5 games"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-base font-semibold",children:"Amenities"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-3",children:"Add amenities available at your venue"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a.amenities.map((s,t)=>{const r=n=>{const i=n.toLowerCase();return i.includes("light")||i.includes("flood")?e.jsx(ae,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):i.includes("parking")||i.includes("car")?e.jsx(re,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):null};return e.jsxs("span",{className:"px-4 py-2 bg-gradient-to-r from-blue-100 to-green-100 dark:from-blue-900 dark:to-green-900 text-blue-700 dark:text-blue-300 rounded-lg text-sm font-medium flex items-center gap-2",children:[r(s),s,e.jsx(h,{type:"button",variant:"ghost",size:"icon",className:"h-4 w-4 text-destructive hover:text-destructive",onClick:()=>V(t),children:e.jsx(f,{className:"h-3 w-3"})})]},t)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{value:j,onChange:s=>v(s.target.value),onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),L())},placeholder:"Add an amenity (e.g., WiFi, Changing Rooms)",className:"max-w-xs"}),e.jsxs(h,{type:"button",variant:"outline",onClick:L,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add Amenity"]})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-base font-semibold",children:"Photos"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-3",children:"Upload up to 3 photos"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 md:gap-4",children:[w.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Venue ${t+1}`,className:"w-full h-48 object-cover rounded-lg border"}),e.jsx("button",{type:"button",onClick:()=>E(t),className:"absolute top-2 right-2 bg-destructive text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(f,{className:"h-4 w-4"})})]},t)),g.length<3&&e.jsxs("label",{className:"flex flex-col items-center justify-center h-48 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx(F,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Upload Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:G,className:"hidden",multiple:!0})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>x("/"),className:"flex-1",children:"Cancel"}),e.jsx(h,{type:"submit",className:"flex-1",disabled:A,children:A?"Submitting...":"Submit Venue"})]})]})})]})})]})};export{ge as default};
